<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Json rules - Writing Reval rules</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../intro.html"><strong aria-hidden="true">1.</strong> Writing rules</a></li><li class="chapter-item expanded "><a href="../json/index.html" class="active"><strong aria-hidden="true">2.</strong> Json rules</a></li><li class="chapter-item expanded "><a href="../json/reference.html"><strong aria-hidden="true">3.</strong> Json rules Reference</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Writing Reval rules</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="json-rules"><a class="header" href="#json-rules">Json rules</a></h1>
<p>Rules written in json will be deprecated in version <code>0.8.0</code> and support will be removed in version <code>0.9.0</code> in favor of rules written in the <a href="../reval/index.html">Reval DSL</a>.</p>
<p>A rule is written as a json structure with a name and an associated expression. The name is what identifies the rule and should be unique in the rule-set.
The expression is what will be evaluated.
The expression is a nested tree-structure. At the root is the first expression that will be evaluated. Expressions can have parameters and depending on the expression these parameters can themselves be expressions.</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;Example rule&quot;,
    &quot;expr&quot;: {&quot;string&quot;: &quot;&quot;}
}
</code></pre>
<h1 id="expressions"><a class="header" href="#expressions">Expressions</a></h1>
<p>Expressions are written as a key-value pair in json, the key is the name of the expression and the value is either one parameter if the expression only takes one parameter. In most cases expressions take more than one parameter so the value will be a list.</p>
<p>Expression names are in lower-case.</p>
<h2 id="value-expressions"><a class="header" href="#value-expressions">Value Expressions</a></h2>
<p>The simpelest expressions are value expressions. Reval values can have different types and there is one value expression for each type. The primitive types that Reval uses are <code>String</code>, <code>Int</code>, <code>Decimal</code>, <code>Float</code> and <code>Bool</code> and there are expressions for each of these;</p>
<pre><code class="language-json">{ &quot;string&quot;: &quot;This is a string value&quot; }
</code></pre>
<pre><code class="language-json">{ &quot;int&quot;: -5 }
</code></pre>
<pre><code class="language-json">{ &quot;decimal&quot;: 5.132 }
</code></pre>
<pre><code class="language-json">{ &quot;float&quot;: 5.15e28 }
</code></pre>
<pre><code class="language-json">{ &quot;bool&quot;: true }
</code></pre>
<h3 id="none-value"><a class="header" href="#none-value">None value</a></h3>
<p><code>none</code> is a special value used to indicate that a value is not available. It can be used when passing values into a rule to indicate a missing value for example.</p>
<pre><code class="language-json">{&quot;none&quot;}
</code></pre>
<p>The expressions <code>is_some</code> and <code>is_none</code> can be used to test for <code>none</code> values. These are documented with the Special Expressions.</p>
<h2 id="comparison-expressions"><a class="header" href="#comparison-expressions">Comparison Expressions</a></h2>
<p>Reval supports a number of comparison expressions that can be used to compare values. Al these expressions result in a boolean value.</p>
<h3 id="eq-and-neq"><a class="header" href="#eq-and-neq">Eq and neq</a></h3>
<p>Eq is short for &quot;equals&quot; and compares equality. It returns true when the two parameters are exactly the same</p>
<pre><code class="language-json">{ &quot;eq&quot;: [{&quot;int&quot;: 5}, {&quot;ref&quot;: &quot;input&quot;}] }
</code></pre>
<p>Neq is short for &quot;not equal&quot; and is the inverse of the <code>eq</code> expression. Compares equality of two parameters and returns <code>false</code> if they are the same.</p>
<pre><code class="language-json">{ &quot;neq&quot;: [{&quot;int&quot;: 5}, {&quot;ref&quot;: &quot;input&quot;}] }
</code></pre>
<h2 id="special-expressions"><a class="header" href="#special-expressions">Special expressions</a></h2>
<p>There are a couple of special expressions that allow express</p>
<h3 id="ref"><a class="header" href="#ref">Ref</a></h3>
<p>The <code>ref</code> expression allow rules to access fields from input data by name</p>
<pre><code class="language-json">{&quot;ref&quot;: &quot;input_field_name&quot;}
</code></pre>
<h3 id="idx"><a class="header" href="#idx">Idx</a></h3>
<p>The <code>idx</code> expression indexes fields from map or vec values.</p>
<p>Fields from a vec can be indexed by number.</p>
<pre><code class="language-json">{&quot;idx&quot;: [{ &quot;ref&quot;: &quot;some_vec_value&quot; }, { &quot;int&quot;: 5 } ]}
</code></pre>
<p>Fields from maps are indexed by string.</p>
<pre><code class="language-json">{&quot;idx&quot;: [{ &quot;ref&quot;: &quot;some_map_value&quot; }, { &quot;string&quot;: &quot;sub-field&quot; } ]}
</code></pre>
<h3 id="none-checks"><a class="header" href="#none-checks">None checks</a></h3>
<p>The <code>is_some</code> and <code>is_none</code> expressions test for none values.</p>
<p><code>is_some</code> checks for <code>none</code> values and returns <code>true</code> if the expression returns a value that is not equal to <code>none</code>.</p>
<pre><code class="language-json">{&quot;is_some&quot;: {&quot;string&quot;: &quot;some value&quot;}}
</code></pre>
<p>This returns <code>true</code> because <code>{&quot;string&quot;: &quot;some value&quot;}</code> is not <code>none</code></p>
<p><code>is_none</code> checks for <code>none</code> values and returns <code>true</code> if the expression returns a value that is equal to <code>none</code>.</p>
<pre><code class="language-json">{&quot;is_none&quot;: &quot;none&quot;}
</code></pre>
<p>This returns <code>true</code></p>
<h3 id="gt-gte-lt-and-lte"><a class="header" href="#gt-gte-lt-and-lte">Gt, gte, lt and lte</a></h3>
<p>Gt is short for &quot;greater than&quot; it compares two numeric values of the same type, lt is &quot;less than&quot; and is the inverse. Gte and lte are the inclusive versions of these operations. They are short for &quot;Greater than or equal&quot; and &quot;Less than or equal&quot;</p>
<pre><code class="language-json">{ &quot;gt&quot;: [{&quot;int&quot;: 5}, {&quot;ref&quot;: &quot;input&quot;}] }
</code></pre>
<pre><code class="language-json">{ &quot;gte&quot;: [{&quot;int&quot;: 5}, {&quot;ref&quot;: &quot;input&quot;}] }
</code></pre>
<pre><code class="language-json">{ &quot;lt&quot;: [{&quot;int&quot;: 5}, {&quot;ref&quot;: &quot;input&quot;}] }
</code></pre>
<pre><code class="language-json">{ &quot;lte&quot;: [{&quot;int&quot;: 5}, {&quot;ref&quot;: &quot;input&quot;}] }
</code></pre>
<h2 id="logic-expressions"><a class="header" href="#logic-expressions">Logic expressions</a></h2>
<p>Logic expressions perform logic operations on boolean values. These can be used to combine results from comparison expressions for example. Logic expressions take one or more boolean expressions as parameters and return a boolean value when evaluated.</p>
<h3 id="not"><a class="header" href="#not">Not</a></h3>
<p>The not expression inverts a boolean value. So <code>true</code> becomes <code>false</code> and <code>false</code> becomes <code>true</code>.</p>
<pre><code class="language-json">{ &quot;not&quot;: { &quot;bool&quot;: false } }
</code></pre>
<h3 id="and"><a class="header" href="#and">And</a></h3>
<p>The logical <code>and</code> expression takes two sub-expressions as parameters and only evaluates to <code>true</code> if both parameters evaluate to <code>true</code>.</p>
<pre><code class="language-json">{
    &quot;and&quot;: [ 
        { &quot;gte&quot;: [{ &quot;ref&quot;: &quot;input_1&quot; }, { &quot;int&quot;: 5 }]},
        { &quot;gte&quot;: [{ &quot;ref&quot;: &quot;input_2&quot; }, { &quot;float&quot;: 15.9 }]}
    ]
}
</code></pre>
<h3 id="or"><a class="header" href="#or">Or</a></h3>
<p>The logical <code>or</code> expression takes two sub-expressions as parameters and only evaluates to <code>false</code> if both parameters evaluate to <code>false</code>.</p>
<pre><code class="language-json">{
    &quot;or&quot;: [ 
        { &quot;gte&quot;: [{ &quot;ref&quot;: &quot;input_1&quot; }, { &quot;int&quot;: 5 }]},
        { &quot;gte&quot;: [{ &quot;ref&quot;: &quot;input_2&quot; }, { &quot;float&quot;: 15.9 }]}
    ]
}
</code></pre>
<h2 id="calculation"><a class="header" href="#calculation">Calculation</a></h2>
<ul>
<li>Add</li>
<li>Sub</li>
<li>Mul</li>
<li>Div</li>
</ul>
<h2 id="conversions"><a class="header" href="#conversions">Conversions</a></h2>
<p>Reval has three expressions that allow conversions between numeric types, each of these takes one expression as a parameter.</p>
<ul>
<li>CFloat</li>
<li>CInt</li>
<li>CDecimal</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../intro.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../json/reference.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../intro.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../json/reference.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
