<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Writing rules - Writing Reval rules</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="intro.html" class="active"><strong aria-hidden="true">1.</strong> Writing rules</a></li><li class="chapter-item expanded "><a href="json/index.html"><strong aria-hidden="true">2.</strong> Json rules</a></li><li class="chapter-item expanded "><a href="json/reference.html"><strong aria-hidden="true">3.</strong> Json rules Reference</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Writing Reval rules</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="writing-reval-rules"><a class="header" href="#writing-reval-rules">Writing Reval rules</a></h1>
<h2 id="intro"><a class="header" href="#intro">Intro</a></h2>
<p>Reval is a library (or crate as libraries are called in Rust, the language that Reval is written in) for managing, interpreting and executing rules.
This document is targeted at people writing rules for Reval. It describes the syntax and structure of the rules. This document does not describe details of a specific Reval implementation. Any information on the structure of input data, output data or extra functions provided by any system that uses Reval should be described in the documentation of that system.</p>
<h2 id="concepts"><a class="header" href="#concepts">Concepts</a></h2>
<h3 id="rules"><a class="header" href="#rules">Rules</a></h3>
<p>Rules are pieces of text describing how to process input data to generate a required output. How the input and output data is structured depends depends on your particular Reval implementation.
Each rule has a name, this name is used to identify the rule in error messages and other output and should be unique in a ruleset. Each rule also contains an expression, this is the actual rule that will be evaluated to generate the output.</p>
<p>Rules can be written in one of two languages. The Reval language is the simpelest and most concise language to write rules. A simple rule written in the Reval language looks like this;</p>
<pre><code>// Example rule
input_field &gt;= i5
</code></pre>
<p>Rules can also be written in a language based on Json, this used to be the only way to write rules and is still available for backward compatibility. Parsing Json rules will be deprecated in version <code>0.8.0</code> of Reval and the Json rules parser will be removed in <code>0.9.0</code>.
The same rule that was specified above looks like this in Json, its quite a bit more verbose and harder to look at;</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;Example rule&quot;,
    &quot;expr&quot;: {&quot;gte&quot;: [{&quot;ref&quot;: &quot;input_field&quot;}, {&quot;int&quot;: &quot;5&quot;}]}
}
</code></pre>
<p>The rule has the name <code>&quot;Example rule&quot;</code> and compares the value in <code>input_field</code> with the integer <code>5</code>. It will return <code>true</code> if it is greater than or equal to 5 and <code>false</code> otherwise. This rule will return an error if <code>input_field</code> does not contain a value with an integer type.</p>
<h3 id="values-and-data-types"><a class="header" href="#values-and-data-types">Values and data types</a></h3>
<p>Values can either be passed in to the the rules as input data or specified in the rule itself.
Values passed in to the rules are named and can be used in rules by specifying the name similar to <code>input_field</code> in the example rule above.
The value <code>i5</code> in the example rule is a value that is specified in the rule itself. The prefix <code>i</code> specifies that the value has the Integer type, and <code>5</code> specifies the value.</p>
<p>Reval supports a range of data-types. The <code>String</code> type for text, a number of numeric types, a boolean type and a </p>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Example</th><th>Description</th></tr></thead><tbody>
<tr><td>String</td><td><code>&quot;this is a String&quot;i</code></td><td>Values of the string type contain text. String values are delimited with <code>&quot;</code> characters.</td></tr>
<tr><td>Integer</td><td><code>i5</code></td><td>This is a numeric type that can contain whole values. Integers can be positive or negative. <code>Integer</code> values are prefixed with <code>i</code> in rules</td></tr>
<tr><td>Float</td><td><code>f.14e-5</code></td><td><code>Float</code> is a numeric type that contains floating point values. Float types can contain fractional values, positive or negative. <code>Float</code> values are prefixed with <code>f</code></td></tr>
<tr><td>Decimal</td><td><code>d14.25</code></td><td><code>Decimal</code> is a numeric type that can contain fractional values. This data-type is similar to <code>Float</code> has different trade-offs. Decimal is typically used for monetary values. <code>Decimal</code> values are prefixed with <code>d</code></td></tr>
<tr><td>Boolean</td><td><code>false</code> or <code>true</code></td><td>The <code>Boolean</code> data type represent truth values and can be <code>true</code> or <code>false</code></td></tr>
<tr><td>None</td><td><code>none</code></td><td><code>None</code> is used to indicate that a value does is not set or unspecified.</td></tr>
<tr><td>Vec</td><td><code>[i4, i6, i12]</code></td><td>Vec values contain a list or vector of other values.</td></tr>
<tr><td>Map</td><td><code>{one: i1, two: i2}</code></td><td>Map values map names to values, They are similar to a vec but every value in the list has a name that can be used to access that value</td></tr>
</tbody></table>
</div>
<h3 id="operators"><a class="header" href="#operators">Operators</a></h3>
<p>todo</p>
<h3 id="built-in-functions"><a class="header" href="#built-in-functions">Built in Functions</a></h3>
<p>todo</p>
<h3 id="user-functions"><a class="header" href="#user-functions">User-Functions</a></h3>
<p>A ruleset can have custom functions that allow rules to access functionality provided by the software that embeds the Reval rules-engine. Functions have a name, take a value as their input and return a value as output. Depending on how the function is implemented the output can be cached. So calling it multiple times might not incur a performance impact. </p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->

                            <a rel="next" href="json/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

                    <a rel="next" href="json/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
